<?php defined('COREINPAGE') or die('Hack!');

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

class content_envelope_0 extends module
{

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

protected $default;
protected $request;

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

function __construct ($configs)
{
	parent::__construct($configs);

	$this->default = isset($configs['default']) ? $configs['default'] : null;
	$this->request = null;
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

function core_content ($args)
{
	$envelope =
		(!is_null($this->request) ? $this->request:
		(defined('ENVELOPE') && (ENVELOPE != '') ? ENVELOPE :
		($this->default)));

	$content = isset($args['data']) ? $args['data'] : null;
	$result = is_null($envelope) ? null : core::template($envelope, compact('content'));
	return  ($result == '') ? $content : $result;
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

function envelope ($args)
{
	$envelope = isset($args['envelope']) ? $args['envelope'] : null;
	if (!is_null($envelope) && !is_scalar($envelope))
		throw new exception("Bad argument: envelope must be either null or scalar.");
	$this->request = ($envelope == '') ? null : $envelope;
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
}

?>