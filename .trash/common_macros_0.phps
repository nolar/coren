<?php defined('COREINPAGE') or die('Hack!');
// Основаня идея модуля и его отличие от прямого вызова core::macros() в том, что макрос вызывается под
// макрофиксом этого, а не вызываюещго модуля. Таким образом становится возможным разработать несколько
// item'ов в рамках категории, которые будут едины для всего сайта, но подпадать под общие алгоритмы
// определения значения категории. Хотя и не исключено, что есть более простой способ. Например, заведение
// еще одной предопределенной категории типа utility. Но тогда все универсальные итемы теряют категоризацию.

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

class common_macros_0 extends module
{

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

protected $category;

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

function __construct ($configs)
{
	parent::__construct($configs);

	$this->category = core::find_scalar(array($configs), array('category'), null);
	if (is_null($this->category)) throw new exception('misconfig_category');
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

function execute ($args)
{
	$item = core::find_scalar(array($args), array('item'), null);
	$data = core::find_value (array($args), array('data'), null, true);
	return core::macros($this->category, $item, $data);
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
}

?>