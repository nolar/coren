<?php defined('CORENINPAGE') or die('Hack!');
####################################################################################################
####################################################################################################
####################################################################################################
#
####################################################################################################
####################################################################################################
####################################################################################################
#
class identify_account_privileges_0 extends coren_module
{
#
####################################################################################################
####################################################################################################
####################################################################################################
#
protected $identified_privilege;
#
####################################################################################################
#
function __construct ($configs)
{
	parent::__construct($configs);

	if (isset($configs['identified_privilege'])) $this->identified_privilege = $configs['identified_privilege'];
}
#
####################################################################################################
####################################################################################################
####################################################################################################
#
# Usually a handler for event {identified-as-account}.
#
public function assign ($data)
{
	$identifier = isset($data['identifier']) ? $data['identifier'] : null;

	$privileges = coren::db('select_privileges', compact('identifier'));
	if (!is_null($this->identified_privilege)) $privileges[] = $this->identified_privilege;
	coren::grant($privileges);
}
#
####################################################################################################
####################################################################################################
####################################################################################################
}
?>