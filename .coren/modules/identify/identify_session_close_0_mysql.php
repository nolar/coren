<?php defined('CORENINPAGE') or die('Hack!');
####################################################################################################
####################################################################################################
####################################################################################################
#
class identify_session_close_0_mysql extends coren_broker
{
#
####################################################################################################
####################################################################################################
####################################################################################################
#
function close_session ($data)
{
	$identifier = $data['identifier'];

	$db = coren::db('handle');
	$table_session = 'auth_session';

	$identifier = "'" . mysql_real_escape_string($identifier, $db) . "'";
	$sql =
	"
		update {$table_session}
		   set `status` = 2, `closed` = now()
		 where `session` = {$identifier} and `status` = 0
	";
	$res = @mysql_query($sql, $db);
	if ($res === false) throw new exception(mysql_error($db), mysql_errno($db));
}
#
####################################################################################################
####################################################################################################
####################################################################################################
}
?>